const Promise = require('bluebird');

const fs = require('fs');
const readFileAsync = Promise.promisify(fs.readFile, fs);
const path = require('path');

const config = require('../config');
const utils = require('../utils');
const render = require('./render');

function engine(route) {
    return Promise.map(config.engine.views, function(viewDir) {
        return Promise.filter(utils.walk(viewDir), function(view) {
            return route === path.basename(view, path.extname(view));
        });
    }).then(function(eligible) {
        var system = eligible.splice(0,1)[0];
        var user = eligible[0];
        console.log(utils.flatten(eligible));
    });
}

module.exports = engine;
