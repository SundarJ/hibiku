const Promise = require('bluebird');

const fs = require('fs');
const readFileAsync = Promise.promisify(fs.readFile, fs);
const path = require('path');

const config = require('../config');
const utils = require('../utils');
const render = require('./render');

function engine(route) {
    var eligible = [];
    Promise.each(config.engine.views, function(viewDir) {
        return utils.walk(viewDir).then(function(views) {
            var valid = views.filter(function(view) {
                return route === path.basename(view, path.extname(view));
            });
            eligible = eligible.concat(valid);
        });
    }).then(function() {
        console.log(eligible);
    });
}

module.exports = engine;