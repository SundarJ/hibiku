{
  var helpers = [':each'];
}

start
  = template:template { return template }

template = 
  t:(open tokens close [\n,]?)+ { return t; }

open = '(('
close = '))'

tokens = tokens:[^()]+ 
  {
    var parts = tokens.join('').split(" ");
    if (helpers.indexOf(parts[0]) > -1)
      return { token: parts[0], context: parts[1] }
    else if (parts[0][parts[0].length-1] === '.')
      return { token: 'skip' };
    else return { token: tokens.join('') };
  }