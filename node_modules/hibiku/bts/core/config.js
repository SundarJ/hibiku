const path = require('path');

module.exports = global.settings = new function() {
    
    this.root = path.join(__dirname, '../..');
    this.user = require(path.relative(__dirname, path.join(require('app-root-path')+'', 'config')));

    this.engine = {
        
        "views": [
            path.join(this.root, "bts/pages")
        ],
        "extension": {
            "hibiku": ".hb",
            "plain": ".html"
        }
    };
    
    const defaults = {
        "db": {
            "host": "localhost",
            "name": "hibiku",
            "user": "",
            "pass": ""
        },
        "options": {
            "locale": "en",
            "frontPage": "index"
        },
        "engine": {
            "views": ["visage"]
        },
        "editor": {
            "hidden": ["components"]
        }
    };
    
    this.user = require('./utils').assign(this.user, defaults);
    this.user.engine.views = this.user.engine.views.map(function (view) {
        return path.join(this.user.root, view);
    }, this);
    this.user.engine.extension = this.user.engine.extension || this.engine.extension;
    
    this.engine.views = this.engine.views.concat(this.user.engine.views);

};