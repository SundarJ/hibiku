const approot = require('app-root-path') + '';
const path = require('path');

var config = require('./package.json').config.hibiku;
config.user = (require(path.relative(__dirname, path.join(approot, 'package.json'))).config || {}).hibiku || config.user;
config.user.root = approot;

function local_abs(loc) {
	return path.join(__dirname, loc);
}

function global_abs(loc) {
	return path.join(approot, loc);
}

config.root = local_abs(config.root);
config.engine.views = config.engine.views.map(local_abs).concat(config.user.engine.views.map(global_abs));
config.user.engine.extension = config.user.engine.extension || config.engine.extension;

console.log(JSON.stringify(config, null, 2));

global.settings = config;